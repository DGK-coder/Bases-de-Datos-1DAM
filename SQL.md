# COMANDOS PARA MARIADB
## CREAR BASE DE DATOS Y USARLA
```sql
CREATE DATABASE TiendasDeVideojuegos;
```
```sql
use TiendasDeVideojuegos;
```
## CREACIÃ“N DE TABLAS
### TABLA `PROVINCIA`
```sql
CREATE TABLE PROVINCIA(
    codProvincia CHAR(36) DEFAULT UUID (),
    nombre VARCHAR(100) NOT NULL,
    CONSTRAINT PK_Provincia PRIMARY KEY (codProvincia),
    CONSTRAINT UK_PROVINCIA_NOMBRE UNIQUE KEY (nombre)
);
```
### TABLA `PRODUCTO`
```sql
CREATE TABLE PRODUCTO(
    id INT UNSIGNED AUTO_INCREMENT,
    nombre VARCHAR(100) NOT NULL, 
    stock INT UNSIGNED,
    fechaVenta DATE,
    compra DECIMAL(6,2) NOT NULL,
    venta DECIMAL(6,2) NOT NULL,
    beneficio DECIMAL(6,2) AS(venta-compra) STORED,
    CONSTRAINT PK_PRODUCTO PRIMARY KEY (id),
    CONSTRAINT UK_PRODUCTO_NOMBRE UNIQUE KEY (nombre)
);
```
### TABLA `PROVENIR`
```sql
CREATE TABLE PROVENIR(
    idProducto INT UNSIGNED,
    codProvincia CHAR(36),
    CONSTRAINT PK_PROVENIR PRIMARY KEY (idProducto, codProvincia),
    CONSTRAINT FK_PROVENIR_PRODUCTO FOREIGN KEY (idProducto) REFERENCES PRODUCTO(id)
        ON DELETE CASCADE
        ON UPDATE CASCADE,
    CONSTRAINT FK_PROVENIR_PROVINCIA FOREIGN KEY (codProvincia) REFERENCES PROVINCIA(codProvincia)
        ON DELETE NO ACTION
        ON UPDATE CASCADE
);
```
### TABLA `CATEGORIA`
```sql
CREATE TABLE CATEGORIA(
    id INT UNSIGNED AUTO_INCREMENT,
    nombre VARCHAR(100) NOT NULL,
    CONSTRAINT PK_CATEGORIA PRIMARY KEY (id),
    CONSTRAINT UK_CATEGORIA UNIQUE KEY (nombre)
);
```
### TABLA `PERTENECER`
```sql
CREATE TABLE PERTENECER(
    idCategoria INT UNSIGNED,
    idProducto INT UNSIGNED,
    CONSTRAINT PK_PERTENECER PRIMARY KEY (idCategoria, idProducto),
    CONSTRAINT FK_PERTENECER_CATEGORIA_IDCATEGORIA FOREIGN KEY (idCategoria) REFERENCES CATEGORIA(id)
        ON DELETE CASCADE
        ON UPDATE CASCADE,
    CONSTRAINT FK_PERTENECER_CATEGORIA_IDPRODUCTO FOREIGN KEY (idProducto) REFERENCES PRODUCTO(id)
        ON DELETE CASCADE
        ON UPDATE CASCADE
);
```
### TABLA `TIENDA`
```sql
CREATE TABLE TIENDA(
    codTienda CHAR(36) DEFAULT UUID(),
    direccion VARCHAR(200) NOT NULL,
    codProvincia CHAR(36),
    cantidad INT UNSIGNED NOT NULL,
    CONSTRAINT PK_TIENDA PRIMARY KEY (codTienda),
    CONSTRAINT FK_TIENDA_PROVINCIA FOREIGN KEY (codProvincia) REFERENCES PROVINCIA(codProvincia)
        ON DELETE NO ACTION
        ON UPDATE CASCADE,
    CONSTRAINT UK_TIENDA_DIRECCION UNIQUE KEY (direccion)
);
```
### TABLA `TELEFONO`
```sql
CREATE TABLE TELEFONO(
    numero CHAR(9),
    codTienda CHAR(36),
    CONSTRAINT PK_TELEFONO PRIMARY KEY (numero),
    CONSTRAINT FK_TELEFONO_TIENDA FOREIGN KEY (codTienda) REFERENCES TIENDA(codTienda)
        ON DELETE CASCADE
        ON UPDATE CASCADE
);
```
### TABLA `DISPONER`
```sql
CREATE TABLE DISPONER(
    idProducto INT UNSIGNED,
    codTienda CHAR(36),
    CONSTRAINT PK_DISPONER PRIMARY KEY (idProducto, codTienda),
    CONSTRAINT FK_DISPONER_PRODUCTO FOREIGN KEY (idProducto) REFERENCES PRODUCTO(id)
        ON DELETE CASCADE
        ON UPDATE CASCADE,
    CONSTRAINT FK_DISPONER_TIENDA FOREIGN KEY (codTienda) REFERENCES TIENDA(codTienda)
        ON DELETE CASCADE
        ON UPDATE CASCADE
);
```
### TABLA `SALA`
```sql
CREATE TABLE SALA(
    num INT UNSIGNED AUTO_INCREMENT,
    codTienda CHAR(36),
    metrosCua INT UNSIGNED,
    nombre VARCHAR(100),
    CONSTRAINT PK_SALA PRIMARY KEY (num),
    CONSTRAINT FK_SALA_TIENDA FOREIGN KEY (codTienda) REFERENCES TIENDA(codTienda)
        ON DELETE CASCADE
        ON UPDATE CASCADE,
    CONSTRAINT UK_SALA_NOMBRE UNIQUE KEY (nombre)
);
```
### TABLA `PERSONAL`
```sql
CREATE TABLE PERSONAL(
    dni CHAR(9),
    nombre VARCHAR(100) NOT NULL,
    apellido1 VARCHAR(100) NOT NULL,
    apellido2 VARCHAR(100),
    codTienda CHAR(36),
    fecha_nac DATE NOT NULL,
    edad INT AS(TIMESTAMPDIFF(YEAR, fecha_nac, CURRENT_DATE)) VIRTUAL,
    CONSTRAINT PK_PERSONAL PRIMARY KEY (dni),
    CONSTRAINT FK_PERSONAL_TIENDA FOREIGN KEY (codTienda) REFERENCES TIENDA(codTienda)
        ON DELETE CASCADE
        ON UPDATE CASCADE
);
```
### TABLA `DEPENDIENTE`
```sql
CREATE TABLE DEPENDIENTE(
    dniDependiente CHAR(9),
    corrIdent VARCHAR(100) NOT NULL,
    CONSTRAINT PK_DEPENDIENTE PRIMARY KEY (dniDependiente),
    CONSTRAINT FK_DEPENDIENTE_PERSONAL FOREIGN KEY (dniDependiente) REFERENCES PERSONAL(dni)
        ON DELETE CASCADE
        ON UPDATE CASCADE,
    CONSTRAINT UK_DEPENDIENTE_CORRIDENT UNIQUE KEY (corrIdent)
);
```
### TABLA `ENSENYAR`
```sql
CREATE TABLE ENSENYAR(
    dniEns CHAR(9),
    dniApr CHAR(9),
    tiempo DATE,
    CONSTRAINT PK_ENSENYAR PRIMARY KEY (dniEns, dniApr),
    CONSTRAINT FK_ENSENYAR_DEPENDIENTE_DNIENS FOREIGN KEY (dniEns) REFERENCES DEPENDIENTE(dniDependiente)
        ON DELETE CASCADE
        ON UPDATE CASCADE,
    CONSTRAINT FK_ENSENYAR_DEPENDIENTE_DNIAPR FOREIGN KEY (dniApr) REFERENCES DEPENDIENTE(dniDependiente)
        ON DELETE CASCADE
        ON UPDATE CASCADE
);
```
### TABLA `VENDER`
```sql
CREATE TABLE VENDER(
    dniDependiente CHAR(9),
    idProducto INT UNSIGNED,
    cantidad INT UNSIGNED,
    CONSTRAINT PK_VENDER PRIMARY KEY (dniDependiente, idProducto),
    CONSTRAINT FK_VENDER_DEPENDIENTE FOREIGN KEY (dniDependiente) REFERENCES DEPENDIENTE(dniDependiente)
        ON DELETE CASCADE
        ON UPDATE CASCADE,
    CONSTRAINT FK_VENDER_PRODUCTO FOREIGN KEY (idProducto) REFERENCES PRODUCTO(id)
        ON DELETE CASCADE
        ON UPDATE CASCADE
);
```
### TABLA `LIMPIEZA`
```sql
CREATE TABLE LIMPIEZA(
    dniLimpieza CHAR(9),
    CONSTRAINT PK_LIMPIEZA PRIMARY KEY (dniLimpieza),
    CONSTRAINT FK_LIMPIEZA_PERSONAL FOREIGN KEY (dniLimpieza) REFERENCES PERSONAL(dni)
        ON DELETE CASCADE
        ON UPDATE CASCADE
);
```
### TABLA `LIMPIAR`
```sql
CREATE TABLE LIMPIAR(
    dniLimpieza CHAR(9),
    numSala INT UNSIGNED,
    codTienda CHAR(36),
    CONSTRAINT PK_LIMPIAR PRIMARY KEY (dniLimpieza, numSala, codTienda),
    CONSTRAINT FK_LIMPIAR_LIMPIEZA FOREIGN KEY (dniLimpieza) REFERENCES LIMPIEZA(dniLimpieza)
        ON DELETE CASCADE
        ON UPDATE CASCADE,
    CONSTRAINT FK_LIMPIAR_SALA FOREIGN KEY (numSala) REFERENCES SALA(num)
        ON DELETE CASCADE
        ON UPDATE CASCADE
);
```

